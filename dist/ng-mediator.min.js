!function(t){"use strict";function e(t,e){if("string"!=typeof t||"function"!=typeof e)throw new Error("First param should be a String, Second parameter should be an function")}function n(t){t=t||{},this._groups={},this._eventMap={},this._registredListenersCount=0,this._maxListeners=t.maxListeners||10,this._logger=t.logger||console.warn.bind(console),this._emit=t.async?this._emitAsync:this._emitSync,this._asyncQueue=t.async?[]:null}function i(t){this._emitSync.apply(this,t)}function o(t){t._asyncQueue.forEach(i,t),t._asyncQueue.length=0}var r={each:function(t,e,n){var i,o;if(Array.isArray(t))for(i=0,o=t.length;o>i&&e.call(n,t[i],i,t)!==!1;i++);else if("object"==typeof t){var r=Object.keys(t);for(i=0,o=r.length;o>i;i++){var s=r[i];if(e.call(n,t[s],s,t)===!1)break}}},extend:function(t,e){this.each(e,function(e,n){t[n]=e})},indexOf:function(t,e){var n=-1;return this.each(t,function(t,i,o){return e(t,i,o)?(n=i,!1):void 0}),n},contains:function(t,e){return!!~t.indexOf(e)},arrayCopy:function(t){return Array.prototype.slice.call(t)},notGroup:function(t){return t.group!==this},notEvent:function(t){return t!==this}};r.extend(n.prototype,{_emitAsync:function(t){this._asyncQueue.length||setTimeout(o,0,this),this._asyncQueue.push(arguments)},_emitSync:function(t){if(this._eventMap[t]){var e=Array.prototype.slice.call(arguments,1),n=!1,i={event:t,group:null,stop:function(){n=!0}};r.each(this._eventMap[t],function(t){return i.group=t.group,t.handler.apply(i,e),!n},this)}},_on:function(t,n){e(t,n);var i,o=this._eventMap;if(r.contains(t,".")){var s=t.split("."),u=this._groups;i=s[1],t=s[0],u[i]?u[i].push(t):u[i]=[t]}o[t]?o[t].push({group:i,handler:n}):o[t]=[{group:i,handler:n}],this._registredListenersCount++,this._registredListenersCount>this._maxListeners&&this._logger&&this._logger("Potentially memory leak was detected, max listeners count ["+this._maxListeners+"], registred ["+this._registredListenersCount+"]")},_off:function(t,e){var n;if(r.contains(t,".")){var i=t.split(".");t=i[0],n=i[1]}t&&n?this._offEventGroup(t,n):n?this._offGroup(n):this._offEvent(t,e)},_offEventGroup:function(t,e){if(this._groups[e]&&this._eventMap[t]){var n=this._eventMap[t].length;this._eventMap[t]=this._eventMap[t].filter(r.notGroup,e);var i=this._eventMap[t].length;this._groups[e]=this._groups[e].filter(r.notEvent,t),this._registredListenersCount-=n-i}},_offGroup:function(t){if(this._groups[t]){var e=r.arrayCopy(this._groups[t]);r.each(e,function(e){this._offEventGroup(e,t)},this),delete this._groups[t]}},_offEvent:function(t,e){if("function"==typeof e&&this._eventMap[t]){var n=r.indexOf(this._eventMap[t],function(t){return t.handler===e});~n&&this._eventMap[t].splice(n,1),this._registredListenersCount--}else if(this._eventMap[t]){var i=this._eventMap[t].length;r.each(this._eventMap[t],function(e){if(e.group){var n=this._groups[e.group],i=n.indexOf(t);n.splice(i,1)}},this),this._registredListenersCount-=i,delete this._eventMap[t]}}}),r.extend(n.prototype,{on:function(t,e){return Array.isArray(t)?r.each(t,function(t){this._on(t,e)},this):this._on(t,e),this},off:function(t,e){return Array.isArray(t)?r.each(t,function(t){this._off(t,e)},this):this._off(t,e),this},many:function(t,e,n){function i(){try{e.apply(this,arguments)}finally{r++,r>=n&&o.off(t,i)}}var o=this,r=0;return n=1>n||"number"!=typeof n?1:n,o.on(t,i),o},once:function(t,e){return this.many(t,e,1)},emit:function(){return this._emit.apply(this,arguments)},getMaxListeners:function(){return this._maxListeners},setMaxListeners:function(t){t>0&&(this._maxListeners=t)},toString:function(){return"[object EventEmitter]"}}),r.extend(n.prototype,{addEventListener:n.prototype.on,removeEventListener:n.prototype.off,trigger:n.prototype.emit}),"undefined"!=typeof module?module.exports=n:"undefined"!=typeof exports?exports.EventEmitter=n:t.EventEmitter=n}(new Function("return this")()),function(t){"use strict";function e(t,e){e=n.extend({emitHistory:!1,emitHistoryLength:0},e),this._eventEmitter=t,this._components={},this._settings=e,this._emitHistory=e.emitHistory?[]:null}var n={each:function(t,e,n){var i,o;if(Array.isArray(t))for(i=0,o=t.length;o>i&&!e.call(n,t[i],i,t);i++);else if("object"==typeof t){var r=Object.keys(t);for(i=0,o=r.length;o>i;i++){var s=r[i];if(e.call(n,t[s],s,t))break}}},extend:function(t,e){return this.each(e,function(e,n){t[n]=e}),t}};n.extend(e,{EVENTS:{ADD:"mediator:component:add",REMOVE:"mediator:component:remove"}}),n.extend(e.prototype,{_pushEmitHistory:function(t,e){this._settings.emitHistory&&(this._emitHistory.push({component:t,event:e}),this._emitHistory.length>this._settings.emitHistoryLength&&this._emitHistory.shift())},addComponent:function(t,i){if(this._components.hasOwnProperty(t))throw new Error("Component ["+t+"] already exist");var o=i(function(){if(!this.hasComponent(t))throw new Error("Try to emit event by unregistered component: ["+t+"]");this._eventEmitter.emit.apply(this._eventEmitter,arguments),this._pushEmitHistory(t,arguments[0])}.bind(this));if("object"!=typeof o)throw new Error("Component: ["+t+"] -> mediator#registrator function should return an object");o.hasOwnProperty("onEvents")&&(n.each(o.onEvents,function(e,n){this._eventEmitter.on(n+"."+t,e)},this),delete o.onEvents),this._components[t]=o,this._eventEmitter.emit(e.EVENTS.ADD,t,o)},removeComponent:function(t){this._eventEmitter.off("."+t);var n=delete this._components[t];return n&&this._eventEmitter.emit(e.EVENTS.REMOVE,t),n},hasComponent:function(t){return!!this._components[t]},getComponent:function(t){return this._components[t]},componentsList:function(){return Object.keys(this._components)},shareResponsibility:function(t){t instanceof e&&(this._eventEmitter=t._eventEmitter)},toString:function(){return"[object Mediator]"}}),"undefined"!=typeof module&&module.exports?exports=module.exports=e:t.Mediator=e}(this),function(t,e,n){"use strict";function i(){this._storage={}}i.prototype.set=function(t,e){this._storage[t]=e},i.prototype.get=function(t){return this._storage[t]},t.module("is.emitter",[]).factory("$emitterFactory",function(){return{create:function(t){return new n(t)}}}),t.module("is.mediator",["is.emitter"]).provider("$mediator",function(){var t,n,o={};this.setEventEmitterSettings=function(e){t=e},this.setMediatorSettings=function(t){n=t},this.$get=["$emitterFactory",function(r){var s=new e(r.create(t),n);return{add:function(t,e,n){var r=this,u=o[t]=new i;s.addComponent(t,e.bind(u)),n&&"function"==typeof n.$on&&n.$on("$destroy",function(){r.remove(t)})},remove:function(t){s.removeComponent(t),delete o[t]},has:function(t){return s.hasComponent(t)},getStorage:function(t){return o[t]},get:function(t){return s.getComponent(t)},list:function(){return s.componentsList()}}}]})}(angular,Mediator,EventEmitter);